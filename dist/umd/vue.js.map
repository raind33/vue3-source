{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["const oldArrayMethods = Array.prototype\n\nexport const newArrayProto = Object.create(oldArrayMethods)\nlet methods = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'splice',\n  'reverse',\n  'sort'\n]\n\nmethods.forEach(method => {\n  newArrayProto[method] = function (...args) {\n    const result = oldArrayMethods[method].apply(this, args)\n    let insert\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        insert = args\n        break\n      case 'splice':\n        insert = args.slice(2)\n        break\n      default:\n        break;\n    }\n\n    if (insert) {\n      this.__ob__.observedArray(insert)\n    }\n    return result\n  }\n})","import { newArrayProto } from './array'\nclass Observer {\n  constructor (data) {\n    Object.defineProperty(data, '__ob__', {\n      enumerable: false,\n      configurable: false,\n      value: this\n    })\n    if (Array.isArray(data)) {\n      data.__proto__ = newArrayProto\n      this.observedArray(data)\n      return\n    }\n    this.walk(data)\n  }\n  observedArray (arr) {\n    arr.forEach(item => {\n      observe(item)\n    })\n  }\n  walk (data) {\n    Object.keys(data).forEach(key => {\n      defineReactive(data, key, data[key])\n    })\n  }\n  \n}\nfunction defineReactive (data, key, val) {\n  observe(val)\n  Object.defineProperty(data, key, {\n    get () {\n      console.log('获取值')\n      return val\n    },\n    set (newVal) {\n      console.log('设置值')\n      if (val === newVal) return\n      observe(newVal)\n      val = newVal\n    }\n  })\n}\nexport function observe (data) {\n  if (typeof data !== 'object' || typeof data === null) {\n    return data\n  }\n\n  if (data.__ob__) return data\n  return new Observer(data)\n}","import { observe } from './observer/index'\nexport function initState (vm) {\n  const opts = vm.$options\n\n  if (opts.props) {\n    initProps(vm)\n  }\n  if (opts.data) {\n    initData(vm)\n  }\n  if (opts.methods) {\n    initMethods(vm)\n  }\n  if (opts.watch) {\n    initWatch(vm)\n  }\n  if (opts.computed) {\n    initComputed(vm)\n  }\n}\n\nfunction initProps () {}\nfunction initData (vm) {\n  let data = vm.$options.data\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data\n  observe(data)\n}\nfunction initMethods () {}\nfunction initWatch () {}\nfunction initComputed () {}","\nimport { initState } from './state'\nexport function initMixin (Vue) {\n  Vue.prototype._init = function (opts) {\n    \n    const vm = this\n    vm.$options = opts\n    initState(vm)\n  }\n}","import { initMixin } from \"./init\"\n\nfunction Vue (options) {\n  this._init(options)\n}\ninitMixin(Vue)\nexport default Vue"],"names":["oldArrayMethods","Array","prototype","newArrayProto","Object","create","methods","forEach","method","args","result","apply","insert","slice","__ob__","observedArray","Observer","constructor","data","defineProperty","enumerable","configurable","value","isArray","__proto__","walk","arr","item","observe","keys","key","defineReactive","val","get","console","log","set","newVal","initState","vm","opts","$options","props","initData","watch","computed","_data","call","initMixin","Vue","_init","options"],"mappings":"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"}