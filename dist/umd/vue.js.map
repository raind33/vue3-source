{"version":3,"file":"vue.js","sources":["../../src/compiler/generate.js","../../src/compiler/html-parser.js","../../src/compiler/index.js","../../src/util.js","../../src/global-api/index.js","../../src/vdom/index.js","../../src/vdom/patch.js","../../src/observer/dep.js","../../src/observer/schedular.js","../../src/observer/watcher.js","../../src/lifecycle.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["const defaultTagRe = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\nexport function generate(ast) {\n  // <div id=\"app\" style=\"color:red\"> hello {{name}} <span>232</span></div>\n  // render () {\n  //   return _c('div', {id:'app',style:{color:'red'}},_v('hello'+_s(name)),_c('span',null,\n  //     _v('232')\n  //   ))\n  // }\n  let children = genChildren(ast.children)\n  let code = `_c('${ast.tag}',${\n    ast.attrs.length ? genProps(ast.attrs):'undefined'\n  }${children?`,${children}`:''})`\n\n  return code\n}\n\nfunction genProps (attrs) {\n  let str = ''\n\n  for(let i = 0; i< attrs.length; i++) {\n    const attr = attrs[i]\n    if (attr.name === 'style') {\n      let obj = {}\n      attr.value.split(';').forEach(item => {\n        const [key, value] = item.split(':')\n        obj[key] = value\n      })\n      attr.value = obj\n    }\n    str+=`${attr.name}:${JSON.stringify(attr.value)},`\n  }\n\n  return `{${str.slice(0, -1)}}`\n}\nfunction genChildren (children) {\n  if (children) {\n    return children = children.map(child => gen(child)).join(',')\n  }\n}\n\nfunction gen (child) {\n  if (child.type === 1) {\n    return generate(child)\n  } else {\n    let text = child.text\n    if (!defaultTagRe.test(text)) {\n      return `_v(${JSON.stringify(text)})`\n    }\n\n    let tokens = []\n    let lastIndex = defaultTagRe.lastIndex = 0\n    let match,index\n    //hello {{name}} wew {{age}}\n    while (match = defaultTagRe.exec(text)) {\n      index = match.index\n      if(index > lastIndex) {\n        tokens.push(JSON.stringify(text.slice(lastIndex, index)))\n      } \n      tokens.push(`_s(${match[1].trim()})`)\n      lastIndex = index + match[0].length\n    }\n\n    if (lastIndex<text.length) {\n      tokens.push(JSON.stringify(text.slice(lastIndex)))\n    }\n    return `_v(${tokens.join('+')})`\n  }\n}\n","const attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\nconst dynamicArgAttribute = /^\\s*((?:v-[\\w-]+:|@|:|#)\\[[^=]+\\][^\\s\"'<>\\/=]*)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\nconst startTagOpen = new RegExp(`^<${qnameCapture}`)\nconst startTagClose = /^\\s*(\\/?)>/\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)\nconst doctype = /^<!DOCTYPE [^>]+>/i\n// #7298: escape - to avoid being passed as HTML comment when inlined in page\nconst comment = /^<!\\--/\nconst conditionalComment = /^<!\\[/\n// <div id=\"app\" mode=2>\n//   23222222222222\n//   <p class=\"log\" model=\"3\">232<span id=\"we\">23</span></p>\n// </div>\nexport function htmlParser(html) {\n  let root\n  let currentParent\n  let stack = []\n  while (html) {\n    const textEnd = html.indexOf('<')\n    if (textEnd === 0) {\n      const startTagMatch = parseStartTag()\n      if (startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs)\n        continue\n      }\n      // </span></p>\n      //  </div>\n      const endTagMatch = html.match(endTag)\n      if (endTagMatch) {\n        advance(endTagMatch[0].length)\n        end(endTagMatch[1]) // 结束标签\n        continue\n      }\n    }\n    // 匹配文本\n    let text\n    if (textEnd > 0) {\n      //   23222222222222\n      //   <p class=\"log\" model=\"3\">232<span id=\"we\">23</span></p>\n      // </div>\n      text = html.substring(0, textEnd)\n    }\n    if (text) {\n      advance(text.length)\n      chars(text)\n    }\n  }\n  // console.log(root, 9999999999)\n  return root\n  function advance(n) {\n    html = html.substring(n)\n  }\n\n  function parseStartTag() {\n    const start = html.match(startTagOpen)\n    if (start) {\n      const match = {\n        tagName: start[1],\n        attrs: [],\n      }\n      advance(start[0].length)\n      let end\n      let attr\n      // 匹配开始标签的属性\n      while (\n        !(end = html.match(startTagClose)) &&\n        (attr = html.match(attribute))\n      ) {\n        match.attrs.push({\n          name: attr[1],\n          value: attr[3] || attr[4] || attr[5],\n        })\n        advance(attr[0].length)\n      }\n      if (end) {\n        advance(end[0].length)\n        return match\n      }\n    }\n  }\n\n  function createASTElement(tagName, attrs) {\n    return {\n      tag: tagName,\n      type: 1, // 元素类型，\n      children: [],\n      attrs,\n      parent,\n    }\n  }\n\n  function start(tagName, attrs) {\n    let element = createASTElement(tagName, attrs)\n    if (!root) {\n      root = element\n    }\n\n    currentParent = element\n    stack.push(element)\n  }\n  function chars(text) {\n    text = text.trim()\n    currentParent.children.push({\n      type: 3,\n      text,\n    })\n  }\n  function end(tagName) {\n    // 在结尾标签处创建父子关系\n    const element = stack.pop()\n    currentParent = stack[stack.length - 1]\n    if (currentParent) {\n      // 闭合时可以知道父亲是谁\n      currentParent.children.push(element)\n      element.parent = currentParent\n    }\n  }\n}\n","import { generate } from \"./generate\";\nimport { htmlParser } from \"./html-parser\";\n\nexport function compileToFunction (template) {\n  const ast = htmlParser(template)\n  const code = generate(ast)\n\n  const render = new Function(`with(this){return ${code}}`)\n  return render\n}","export function proxy (vm, data, key) {\n  Object.defineProperty(vm, key, {\n    get () {\n      return vm[data][key]\n    },\n    set (val) {\n      vm[data][key] = val\n    }\n  })\n}\n\nexport function defineProperty (target, key, value) {\n  Object.defineProperty(target, key, {\n    enumerable: false,\n    configurable: false,\n    value\n  })\n}\n\nlet callbacks = []\nlet waiting = false\nfunction flushCallback () {\n  for(let i = 0; i < callbacks.length; i++) {\n    callbacks[i]()\n  }\n  waiting = false\n}\n// 1.第一次cb渲染watcher更新操作调用nextTick,页面初渲染\n// 2. 第二次是用户主动调用nextTick的cb\n// 3.所以当在页面中使用nextTick,页面渲染与nextTick的回调都是在宏任务结束后同步执行，渲染先\n\nexport function nextTick(cb) {\n  callbacks.push(cb)\n  if (!waiting) {\n    waiting = true\n    Promise.resolve().then(flushCallback) // 多次调用nextTick，只执行一次\n  }\n}\n\nconst hooks = [\n  'beforeCreate',\n  'created',\n  'beforeMount',\n  'mounted'\n]\nconst strat = {}\nstrat.components = mergeComponents\nfunction mergeComponents (parent, child) {\n  const res = Object.create(parent)\n  if (child) {\n\n    for(let key in child) {\n      res[key] = child[key]\n    }\n  }\n  return res\n}\nhooks.forEach(hook => {\n  strat[hook] = mergeHook\n})\nfunction mergeHook (parent, child) {\n  if (child) {\n    if (parent) {\n      return parent.concat(child)\n    } else {\n      return [child]\n    }\n  } else {\n    return parent\n  }\n}\nexport function mergeOptions (parent, child) {\n  let options = {}\n\n  for (let key in parent) {\n    mergeField(key)\n  }\n  for (let key in child) {\n    if (!parent.hasOwnProperty(key)) {\n      mergeField(key)\n    }\n  }\n  return options\n  function mergeField (key) {\n    if (strat[key]) {\n      options[key] = strat[key](parent[key], child[key])\n      return\n    }\n    if (isObj(parent[key]) && isObj(child[key])) {\n      options[key] = Object.assign(parent[key], child[key])\n    } else {\n      if (child[key]) {\n        options[key] = child[key]\n      } else if (parent[key]) {\n        options[key] = parent[key]\n      }\n    }\n\n  }\n\n}\n\nexport function isObj (val) {\n  return typeof val === 'object' && typeof val !== 'null'\n}\n\n\nfunction makeup (str) {\n  const map = {}\n  str.split(',').forEach(tag => {\n    map[tag] = true\n  })\n  return (val) => map[val] || false\n}\nexport const isReservedTag = makeup('a,p,ul,li,ol,div,span,input,button')","import { mergeOptions } from \"../util\"\n\nexport function initGlobalApi (Vue) {\n  Vue.options = {}\n\n  Vue.mixin = function (options) {\n    this.options = mergeOptions(this.options, options)\n    console.log(this.options)\n\n  }\n\n  Vue.options.components = {}\n  Vue.options._base = Vue\n  Vue.component = function (id, definition) {\n    definition.name = id || definition.name\n    definition = this.options._base.extend(definition)\n    this.options.components[id] = definition\n    \n  }\n  let cid = 0\n  Vue.extend = function (options) {\n    const Super = this\n\n    const Sub = function VueComponent (options) {\n      this._init(options)\n    }\n    Sub.cid = cid++\n    Sub.prototype = Object.create(Super.prototype)\n    Sub.prototype.constructor = Sub\n    Sub.component = Super.component\n\n    Sub.options = mergeOptions(Super.options, options)\n\n    return Sub\n  }\n}\n\n","import { isReservedTag, isObj } from '../util'\n\nexport function renderMixin(Vue) {\n  Vue.prototype._c = function () {\n    const vm = this\n    return createElement(vm, ...arguments)\n  }\n  Vue.prototype._s = function (val) {\n    return val === null\n      ? ''\n      : typeof val === 'object'\n      ? JSON.stringify(val)\n      : val\n  }\n  Vue.prototype._v = function (text) {\n    const vm = this\n    return createTextVnode(vm, text)\n  }\n  Vue.prototype._render = function () {\n    const vm = this\n    const render = vm.$options.render\n\n    const vnode = render.call(vm)\n    return vnode\n  }\n}\n\nfunction createElement(vm, tag, data = {}, ...children) {\n  if (!isReservedTag(tag)) {\n    const Ctor = vm.$options.components[tag]\n    return createComponent(vm, tag, data, data.key, children, Ctor)\n  }\n\n  return vnode(vm, tag, data, data.key, children)\n}\n\n// 创建组件vnode\nfunction createComponent(vm, tag, data, key, children, Ctor) {\n  if (isObj(Ctor)) {\n    Ctor = vm.$options._base.extend(Ctor)\n  }\n  // 给组件增加生命周期\n  data.hook = {\n    init(vnode) {\n      const child = vnode.componentInstance = new vnode.componentOptions.Ctor({})\n      child.$mount()\n    },\n  }\n  return vnode(\n    vm,\n    `vue-component-${Ctor.cid}-${tag}`,\n    data,\n    key,\n    undefined,\n    undefined,\n    { Ctor }\n  )\n}\n\nfunction createTextVnode(vm, text) {\n  return vnode(vm, undefined, undefined, undefined, undefined, text)\n}\n\nfunction vnode(vm, tag, data, key, children, text, componentOptions) {\n  return {\n    vm,\n    tag,\n    data,\n    key,\n    children,\n    text,\n    componentOptions,\n  }\n}\n\nexport function isSameNode (oldNode, newNode) {\n  if (oldNode.tag === newNode.tag && oldNode.key === newNode.key) return true\n  return false\n}\n","import { isSameNode } from \".\"\n\nexport function patch (oldVnode, vnode) {\n\n  if(!oldVnode) {\n    return createEle(vnode)\n  }\n  const isRealEl = oldVnode.nodeType\n  if (isRealEl) {\n    let el = createEle(vnode)\n    let parentEl = oldVnode.parentNode\n    parentEl.insertBefore(el, oldVnode.nextSibling)\n    parentEl.removeChild(oldVnode)\n    return el\n  } else {\n    // diff算法\n    //1.标签类型不同 直接删除老的\n    if(oldVnode.tag !== vnode.tag) {\n      oldVnode.el.parentNode.replaceChild(createEle(vnode), oldVnode.el)\n      return\n    }\n    // 2.文本类型\n    if(!oldVnode.tag) {\n      if(oldVnode.text !== vnode.text) {\n        oldVnode.el.textContent = vnode.text\n        return oldVnode.el\n      }\n    }\n    // 3.元素类型相同,复用老节点，并且更新属性\n    let el = vnode.el = oldVnode.el\n    patchProps(vnode, oldVnode.data || {})\n\n    // 4. 更新儿子\n    //  1. 老的有儿子新的也有儿子domdiff\n    let oldChildren = oldVnode.children || []\n    let newChildren = vnode.children || []\n    if (oldChildren.length > 0 && newChildren.length > 0 ) {\n      updateChildren(el, oldChildren, newChildren)\n    } else if(oldChildren.length > 0) {//  2. 老的有儿子 新的没有儿子 =》删除老儿子\n      el.innerHTML = ''\n    } else {//  3. 新的有儿子 老的的没有儿子 =》老节点上直接增加儿子\n      newChildren.forEach(child => el.appendChild(createEle(child)))\n    }\n    \n    \n  }\n}\nfunction updateChildren (parent, oldChildren, newChildren) {\n  // 双指针比较法\n  let oldStartIndex = 0 // 老的头索引\n  let oldEndIndex = oldChildren.length - 1 // 老的尾索引\n  let oldStartNode = oldChildren[0] // 老的开始节点\n  let oldEndNode = oldChildren[oldEndIndex] // 老的结束节点\n\n  let newStartIndex = 0 // 新的头索引\n  let newEndIndex = newChildren.length - 1 // 新的尾索引\n  let newStartNode = newChildren[0] // 新的开始节点\n  let newEndNode = newChildren[newEndIndex] // 新的结束节点\n  let keyToOldIndexMap = getKeyToOldIndexMap(oldChildren) // 旧子节点key与index的映射关系\n  function getKeyToOldIndexMap (children) {\n    let map = {}\n    for(let i = 0; i < children.length; i++) {\n      const child = children[i]\n      map[child.key] = i\n    }\n    return map\n  }\n  while(oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex) {\n    if (!oldStartNode) {\n      oldStartNode = oldChildren[++oldStartIndex]\n    } else if (!oldEndNode) {\n      oldEndNode = oldChildren[--oldEndIndex]\n    } else if (isSameNode(oldStartNode, newStartNode)) { //头比较\n      patch(oldStartNode, newStartNode)\n      oldStartNode = oldChildren[++oldStartIndex]\n      newStartNode = newChildren[++newStartIndex]\n    } else if (isSameNode(oldEndNode, newEndNode)) { //尾比较\n      patch(oldEndNode, newEndNode)\n      oldEndNode = oldChildren[--oldEndIndex]\n      newEndNode = newChildren[--newEndIndex]\n    } else if (isSameNode(oldStartNode, newEndNode)) { // 假设children刚好倒序，头尾比较\n      patch(oldStartNode, newEndNode)\n      parent.insertBefore(oldStartNode.el, oldEndNode.el.nextSibling)\n      oldStartNode = oldChildren[++oldStartIndex]\n      newEndNode = newChildren[--newEndIndex]\n    } else if (isSameNode(oldEndNode, newStartNode)) { //尾头比较\n      patch(oldEndNode, newStartNode)\n      parent.insertBefore(oldEndNode.el, oldStartNode.el)\n      oldEndNode = oldChildren[--oldEndIndex]\n      newStartNode = newChildren[++newStartIndex]\n    } else {  // 乱序比较 a b c d f\n      // n a c b e\n      const moveIndex = keyToOldIndexMap[newStartNode.key]\n      if (moveIndex === undefined) { // 如果新的在旧的没找到直接添加\n        parent.insertBefore(createEle(newStartNode), oldStartNode.el)\n      } else {\n        const moveNode = oldChildren[moveIndex]\n        oldChildren[moveIndex] = undefined\n        patch(moveNode, newStartNode)\n        parent.insertBefore(moveNode.el, oldStartNode.el)\n      }\n      newStartNode = newChildren[++newStartIndex]\n    }\n  }\n  // 新字节点有多余\n  if(newStartIndex <= newEndIndex) {\n    for(let i = newStartIndex; i <= newEndIndex; i++) {\n      let ele = !newChildren[newEndIndex+1] ? null : newChildren[newEndIndex+1].el\n      parent.insertBefore(createEle(newChildren[i]), ele)\n    }\n  }\n  // 旧子节点有多余\n  if(oldStartIndex <= oldEndIndex) {\n    for(let i = oldStartIndex; i <= oldEndIndex; i++) {\n      if (oldChildren[i] !== undefined) {\n        parent.removeChild(oldChildren[i].el)\n      }\n    }\n  }\n  \n}\nexport function createEle (vnode) {\n  let { tag, data, children, key, text } = vnode\n  if (typeof tag === 'string') {\n    if(createComponent(vnode)){\n      return vnode.componentInstance.$el\n    }\n    vnode.el  = document.createElement(tag)\n    patchProps(vnode)\n    children.forEach(child => {\n      vnode.el.appendChild(createEle(child))\n    })\n  } else {\n    vnode.el = document.createTextNode(text)\n  }\n\n  return vnode.el\n}\n\nfunction createComponent (vnode) {\n  const { data } = vnode\n  let i\n  if((i = data.hook) && (i = i.init)) {\n    i(vnode) // 调用组件的初始化方法\n    if (vnode.componentInstance) {\n      return true\n    }\n  }\n  return false\n}\nfunction patchProps (vnode, oldProps = {}) {\n  const newProps = vnode.data || {}\n  const el = vnode.el\n  //1. 老的属性有，新的没有，删除没有的\n  for(let key in oldProps) {\n    if(!newProps[key]) {\n      el.removeAttribute(key)\n    }\n  }\n  // style特殊处理\n  let oldStyle = oldProps.style || {}\n  let newStyle = newProps.style || {}\n  for(let key in oldStyle) {\n    if(!newStyle[key]) {\n      el.style[key] = ''\n    }\n  }\n  //2.老的属性没有，新的属性有，直接增加\n  for(let key in newProps) {\n    if (key === 'style') {\n      for (let s in newProps[key]) {\n        el.style[s] = newProps[key][s]\n      }\n    } else if (key === 'class') {\n      el.className = newProps[key]\n    } else {\n      el.setAttribute(key, newProps[key])\n    }\n\n  }\n}","let id = 0\nclass Dep {\n  constructor () {\n    this.id = id++\n    this.subs = [] // 需要记住的watcher\n  }\n\n  depend () {\n    Dep.target.addDep(this)\n  }\n\n  addSub (watcher) {\n    this.subs.push(watcher)\n    console.log(this.subs)\n  }\n\n  notify () {\n    this.subs.forEach(watcher => {\n      watcher.update()\n    })\n  }\n}\n\nDep.target = null\n\nexport function pushTarget (watcher) {\n  Dep.target = watcher\n}\n\nexport function popTarget () {\n  Dep.target = null\n}\nexport default Dep","import { nextTick } from \"../util\"\n\nlet queue = []\nlet has = {}\nlet pending = false\nfunction flushSchedular () {\n  for (let i = 0; i < queue.length; i++) {\n    const watcher = queue[i]\n    watcher.run()\n  }\n  queue = []\n  has = {}\n  pending = false\n}\n// 多次调用queueWatcher， 如果watcher不是同一个也会重复调用nextTick\nexport function queueWatcher (watcher) {\n  const id = watcher.id\n  if (has[id] == null) {\n    queue.push(watcher)\n    has[id] = true\n    if(!pending) {\n      pending = true\n      nextTick(flushSchedular)\n    }\n  }\n}","import { popTarget, pushTarget } from \"./dep\"\nimport { queueWatcher } from \"./schedular\"\n\nlet id = 0\nexport default class Watcher {\n  constructor (vm, exprOrFn, cb, options={}) {\n    this.vm = vm\n    this.cb = cb\n    this.options = options\n    this.user = options.user\n    if (typeof exprOrFn === 'string') {\n      this.getter = function () {\n        const path = exprOrFn.split('.')\n        let val = vm\n        for(let i = 0; i< path.length;i++) {\n          const key = path[i]\n          val = val[key]\n        }\n        return val\n      }\n    } else {\n\n      this.getter = exprOrFn\n    }\n    this.id = id++\n    this.deps = []\n    this.depsId = new Set()\n    if (this.options.immediate) {\n      this.cb()\n    }\n    this.val = this.get()\n  }\n\n  // 当属性取值时，需要记住这个watcher。数据再次变化，就去执行自己记住的这个watcher\n  get () { // 这个方法会对属性进行取值\n    pushTarget(this)\n    const val = this.getter()\n    popTarget()\n    return val\n  }\n\n  addDep (dep) {\n    if (!this.depsId.has(dep.id)) {\n      this.depsId.add(dep.id)\n      this.deps.push(dep)\n      dep.addSub(this)\n    }\n  }\n  run () {\n    let newVal = this.get()\n    let oldval = this.val\n    this.val = newVal\n    if (this.user) {\n      this.cb.call(this.vm, newVal, oldval)\n    }\n  }\n  update () {\n    queueWatcher(this)\n    // this.get()\n  }\n}","import { patch } from \"./vdom/patch\"\nimport Watcher from \"./observer/watcher\"\n\nexport function lifecycleMixin (Vue) {\n  Vue.prototype._update = function (vnode) {\n    const vm = this\n    const prev = vm._vnode\n    vm._vnode = vnode\n    if (!prev) {\n\n      vm.$el = patch(vm.$el, vnode)\n    } else {\n      vm.$el = patch(prev, vnode)\n    }\n    console.log(vm.$el)\n  }\n}\nexport function callHook (vm, key) {\n  const handlers = vm.$options[key]\n  handlers && handlers.forEach(handle => handle.call(vm))\n}\nexport function mountComponent (vm) {\n\n  const updateComponent = () => {\n\n    vm._update(vm._render())\n  }\n\n  // true代表是渲染watcher\n  new Watcher(vm, updateComponent, () => {}, true)\n}","const oldArrayMethods = Array.prototype\n\nexport const newArrayProto = Object.create(oldArrayMethods)\nlet methods = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'splice',\n  'reverse',\n  'sort'\n]\n\nmethods.forEach(method => {\n  newArrayProto[method] = function (...args) {\n    const result = oldArrayMethods[method].apply(this, args)\n    let insert\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        insert = args\n        break\n      case 'splice':\n        insert = args.slice(2)\n        break\n      default:\n        break;\n    }\n\n    if (insert) {\n      this.__ob__.observedArray(insert)\n    }\n    this.__ob__.dep.notify()\n    return result\n  }\n})","import { newArrayProto } from './array'\nimport { defineProperty } from '../util'\nimport Dep from './dep'\nclass Observer {\n  constructor (data) {\n    this.dep = new Dep() // 给数组和对象本身增加一个dep属性\n    defineProperty(data, '__ob__', this)\n    if (Array.isArray(data)) {\n      data.__proto__ = newArrayProto\n      this.observedArray(data)\n      return\n    }\n    this.walk(data)\n  }\n  observedArray (arr) {\n    arr.forEach(item => {\n      observe(item)\n    })\n  }\n  walk (data) {\n    Object.keys(data).forEach(key => {\n      defineReactive(data, key, data[key])\n    })\n  }\n  \n}\n\n// 让里层数组收集外层数组的依赖，这样修改里层数组也可以更新视图\nfunction dependArray (val) {\n  for(let i = 0; i < val.length;i++) {\n    const current = val[i]\n    current.__ob__ && current.__ob__.dep.depend()\n    if (Array.isArray(current)) {\n      dependArray(current)\n    }\n  }\n}\nfunction defineReactive (data, key, val) {\n  const childOb = observe(val)\n\n  const dep = new Dep() // 每次都会给属性创建一个dep\n\n  Object.defineProperty(data, key, {\n    get () {\n      // console.log('获取值')\n      if (Dep.target) {\n        dep.depend() // 让这个属性自己的dep记住这个watcher\n        if (childOb) {\n          childOb.dep.depend()\n          if (Array.isArray(val)) {\n            dependArray(val)\n          }\n        }\n      }\n      return val\n    },\n    set (newVal) {\n      // console.log('设置值')\n      if (val === newVal) return\n      observe(newVal)\n      val = newVal\n      dep.notify()\n    }\n  })\n}\nexport function observe (data) {\n  if (typeof data !== 'object' || typeof data === null) {\n    return\n  }\n\n  if (data.__ob__) return data\n  return new Observer(data)\n}","import { observe } from './observer/index'\nimport { proxy } from './util'\nimport Watcher from './observer/watcher'\n \nexport function initState (vm) {\n  const opts = vm.$options\n\n  if (opts.props) {\n    initProps(vm)\n  }\n  if (opts.data) {\n    initData(vm)\n  }\n  if (opts.methods) {\n    initMethods(vm)\n  }\n  if (opts.watch) {\n    initWatch(vm)\n  }\n  if (opts.computed) {\n    initComputed(vm)\n  }\n}\n\nfunction initProps () {}\nfunction initData (vm) {\n  let data = vm.$options.data\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data\n  for (let key in data) {\n    proxy(vm, '_data', key)\n  }\n  observe(data)\n}\nfunction initMethods () {}\nfunction initWatch (vm) {\n  const watch = vm.$options.watch\n  for(let key in watch) {\n    let handler = watch[key]\n    if (Array.isArray(handler)) { // 字符串、数组、对象、函数\n      val.forEach(handler => createUserWatcher(vm, key, handler))\n    } {\n      createUserWatcher(vm, key, handler)\n    }\n  }\n}\n\nfunction createUserWatcher (vm, exprOrfn, handler, options = {}) {\n  if (typeof handler === 'object') {\n    options = handler\n    handler = handler.handler\n  }\n  if (typeof handler === 'string') {\n    handler = vm[handler]\n  }\n  vm.$watch(exprOrfn, handler, options)\n}\nfunction initComputed () {}","\nimport { compileToFunction } from './compiler/index'\nimport { callHook, mountComponent } from './lifecycle'\nimport { initState } from './state'\nimport { mergeOptions, nextTick } from './util'\nimport Watcher from \"./observer/watcher\"\n\nexport function initMixin (Vue) {\n  Vue.prototype._init = function (opts) {\n    \n    const vm = this\n    vm.$options = mergeOptions(vm.constructor.options, opts)\n    console.log(vm.$options)\n    callHook(vm, 'beforeCreate')\n    initState(vm)\n    callHook(vm, 'created')\n    if (vm.$options.el) {\n      vm.$mount(vm.$options.el)\n    }\n\n  }\n  Vue.prototype.$nextTick = nextTick\n  Vue.prototype.$watch = function (exOrFn, cb, options) {\n    const watcher = new Watcher(this, exOrFn, cb, {...options, user: true})\n  }\n  Vue.prototype.$mount = function (el) {\n    const vm = this\n    const opts = vm.$options\n\n    el = document.querySelector(el)\n    vm.$el = el\n    if (!opts.render) {\n      let template = opts.template\n      if (!template && el) {\n        template = el.outerHTML\n      }\n      opts.render = compileToFunction(template)\n    }\n\n    mountComponent(vm)\n  }\n}","import { compileToFunction } from \"./compiler\"\nimport { initGlobalApi } from \"./global-api/index\"\nimport { initMixin } from \"./init\"\nimport { lifecycleMixin } from \"./lifecycle\"\nimport { renderMixin } from \"./vdom/index\"\nimport { createEle, patch } from './vdom/patch'\nfunction Vue (options) {\n  this._init(options)\n}\ninitMixin(Vue)\nrenderMixin(Vue)\nlifecycleMixin(Vue)\ninitGlobalApi(Vue)\n\nexport default Vue"],"names":["defaultTagRe","generate","ast","children","genChildren","code","tag","attrs","length","genProps","str","i","attr","name","obj","value","split","forEach","item","key","JSON","stringify","slice","map","child","gen","join","type","text","test","tokens","lastIndex","match","index","exec","push","trim","attribute","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","htmlParser","html","root","currentParent","stack","textEnd","indexOf","startTagMatch","parseStartTag","start","tagName","endTagMatch","advance","end","substring","chars","n","createASTElement","parent","element","pop","compileToFunction","template","render","Function","proxy","vm","data","Object","defineProperty","get","set","val","target","enumerable","configurable","callbacks","waiting","flushCallback","nextTick","cb","Promise","resolve","then","hooks","strat","components","mergeComponents","res","create","hook","mergeHook","concat","mergeOptions","options","mergeField","hasOwnProperty","isObj","assign","makeup","isReservedTag","initGlobalApi","Vue","mixin","console","log","_base","component","id","definition","extend","cid","Super","Sub","VueComponent","_init","prototype","constructor","renderMixin","_c","createElement","arguments","_s","_v","createTextVnode","_render","$options","vnode","call","Ctor","createComponent","init","componentInstance","componentOptions","$mount","undefined","isSameNode","oldNode","newNode","patch","oldVnode","createEle","isRealEl","nodeType","el","parentEl","parentNode","insertBefore","nextSibling","removeChild","replaceChild","textContent","patchProps","oldChildren","newChildren","updateChildren","innerHTML","appendChild","oldStartIndex","oldEndIndex","oldStartNode","oldEndNode","newStartIndex","newEndIndex","newStartNode","newEndNode","keyToOldIndexMap","getKeyToOldIndexMap","moveIndex","moveNode","ele","$el","document","createTextNode","oldProps","newProps","removeAttribute","oldStyle","style","newStyle","s","className","setAttribute","Dep","subs","depend","addDep","addSub","watcher","notify","update","pushTarget","popTarget","queue","has","pending","flushSchedular","run","queueWatcher","Watcher","exprOrFn","user","getter","path","deps","depsId","Set","immediate","dep","add","newVal","oldval","lifecycleMixin","_update","prev","_vnode","callHook","handlers","handle","mountComponent","updateComponent","oldArrayMethods","Array","newArrayProto","methods","method","args","result","apply","insert","__ob__","observedArray","Observer","isArray","__proto__","walk","arr","observe","keys","defineReactive","dependArray","current","childOb","initState","opts","props","initData","watch","initWatch","computed","_data","handler","createUserWatcher","exprOrfn","$watch","initMixin","$nextTick","exOrFn","querySelector","outerHTML"],"mappings":"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"}