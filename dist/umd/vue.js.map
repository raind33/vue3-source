{"version":3,"file":"vue.js","sources":["../../src/compiler/generate.js","../../src/compiler/html-parser.js","../../src/compiler/index.js","../../src/vdom/patch.js","../../src/lifecycle.js","../../src/observer/array.js","../../src/util.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/vdom/index.js","../../src/index.js"],"sourcesContent":["const defaultTagRe = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\nexport function generate(ast) {\n  // <div id=\"app\" style=\"color:red\"> hello {{name}} <span>232</span></div>\n  // render () {\n  //   return _c('div', {id:'app',style:{color:'red'}},_v('hello'+_s(name)),_c('span',null,\n  //     _v('232')\n  //   ))\n  // }\n  let children = genChildren(ast.children)\n  let code = `_c('${ast.tag}',${\n    ast.attrs.length ? genProps(ast.attrs):'undefined'\n  }${children?`,${children}`:''})`\n\n  return code\n}\n\nfunction genProps (attrs) {\n  let str = ''\n\n  for(let i = 0; i< attrs.length; i++) {\n    const attr = attrs[i]\n    if (attr.name === 'style') {\n      let obj = {}\n      attr.value.split(';').forEach(item => {\n        const [key, value] = item.split(':')\n        obj[key] = value\n      })\n      attr.value = obj\n    }\n    str+=`${attr.name}:${JSON.stringify(attr.value)},`\n  }\n\n  return `{${str.slice(0, -1)}}`\n}\nfunction genChildren (children) {\n  if (children) {\n    return children = children.map(child => gen(child)).join(',')\n  }\n}\n\nfunction gen (child) {\n  if (child.type === 1) {\n    return generate(child)\n  } else {\n    let text = child.text\n    if (!defaultTagRe.test(text)) {\n      return `_v(${JSON.stringify(text)})`\n    }\n\n    let tokens = []\n    let lastIndex = defaultTagRe.lastIndex = 0\n    let match,index\n    //hello {{name}} wew {{age}}\n    while (match = defaultTagRe.exec(text)) {\n      index = match.index\n      if(index > lastIndex) {\n        tokens.push(JSON.stringify(text.slice(lastIndex, index)))\n      } \n      tokens.push(`_s(${match[1].trim()})`)\n      lastIndex = index + match[0].length\n    }\n\n    if (lastIndex<text.length) {\n      tokens.push(JSON.stringify(text.slice(lastIndex)))\n    }\n    return `_v(${tokens.join('+')})`\n  }\n}\n","const attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\nconst dynamicArgAttribute = /^\\s*((?:v-[\\w-]+:|@|:|#)\\[[^=]+\\][^\\s\"'<>\\/=]*)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\nconst startTagOpen = new RegExp(`^<${qnameCapture}`)\nconst startTagClose = /^\\s*(\\/?)>/\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)\nconst doctype = /^<!DOCTYPE [^>]+>/i\n// #7298: escape - to avoid being passed as HTML comment when inlined in page\nconst comment = /^<!\\--/\nconst conditionalComment = /^<!\\[/\n// <div id=\"app\" mode=2>\n//   23222222222222\n//   <p class=\"log\" model=\"3\">232<span id=\"we\">23</span></p>\n// </div>\nexport function htmlParser(html) {\n  let root\n  let currentParent\n  let stack = []\n  while (html) {\n    const textEnd = html.indexOf('<')\n    if (textEnd === 0) {\n      const startTagMatch = parseStartTag()\n      if (startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs)\n        continue\n      }\n      // </span></p>\n      //  </div>\n      const endTagMatch = html.match(endTag)\n      if (endTagMatch) {\n        advance(endTagMatch[0].length)\n        end(endTagMatch[1]) // 结束标签\n        continue\n      }\n    }\n    // 匹配文本\n    let text\n    if (textEnd > 0) {\n      //   23222222222222\n      //   <p class=\"log\" model=\"3\">232<span id=\"we\">23</span></p>\n      // </div>\n      text = html.substring(0, textEnd)\n    }\n    if (text) {\n      advance(text.length)\n      chars(text)\n    }\n  }\n  console.log(root, 9999999999)\n  return root\n  function advance(n) {\n    html = html.substring(n)\n  }\n\n  function parseStartTag() {\n    const start = html.match(startTagOpen)\n    if (start) {\n      const match = {\n        tagName: start[1],\n        attrs: [],\n      }\n      advance(start[0].length)\n      let end\n      let attr\n      // 匹配开始标签的属性\n      while (\n        !(end = html.match(startTagClose)) &&\n        (attr = html.match(attribute))\n      ) {\n        match.attrs.push({\n          name: attr[1],\n          value: attr[3] || attr[4] || attr[5],\n        })\n        advance(attr[0].length)\n      }\n      if (end) {\n        advance(end[0].length)\n        console.log(html)\n        return match\n      }\n    }\n  }\n\n  function createASTElement(tagName, attrs) {\n    return {\n      tag: tagName,\n      type: 1, // 元素类型，\n      children: [],\n      attrs,\n      parent,\n    }\n  }\n\n  function start(tagName, attrs) {\n    let element = createASTElement(tagName, attrs)\n    if (!root) {\n      root = element\n    }\n\n    currentParent = element\n    stack.push(element)\n  }\n  function chars(text) {\n    text = text.trim()\n    currentParent.children.push({\n      type: 3,\n      text,\n    })\n    console.log(text, 'text')\n  }\n  function end(tagName) {\n    // 在结尾标签处创建父子关系\n    const element = stack.pop()\n    currentParent = stack[stack.length - 1]\n    if (currentParent) {\n      // 闭合时可以知道父亲是谁\n      currentParent.children.push(element)\n      element.parent = currentParent\n    }\n    console.log(tagName, '------结束标签------')\n  }\n}\n","import { generate } from \"./generate\";\nimport { htmlParser } from \"./html-parser\";\n\nexport function compileToFunction (template) {\n  const ast = htmlParser(template)\n  const code = generate(ast)\n\n  const render = new Function(`with(this){return ${code}}`)\n  console.log(render)\n  return render\n}","export function patch (oldVnode, vnode) {\n  console.log(vnode)\n\n  let el = createEle(vnode)\n  let parentEl = oldVnode.parentNode\n  parentEl.insertBefore(el, oldVnode.nextSibling)\n  parentEl.removeChild(oldVnode)\n}\n\nfunction createEle (vnode) {\n  let { tag, data, children, key, text } = vnode\n  if (typeof tag === 'string') {\n    vnode.el  = document.createElement(tag)\n    patchProps(vnode)\n    children.forEach(child => {\n      vnode.el.appendChild(createEle(child))\n    })\n  } else {\n    vnode.el = document.createTextNode(text)\n  }\n\n  return vnode.el\n}\n\nfunction patchProps (vnode) {\n  const newProps = vnode.data || {}\n  const el = vnode.el\n  for(let key in newProps) {\n    if (key === 'style') {\n      for (let s in newProps[key]) {\n        el.style[s] = newProps[key][s]\n      }\n    } else if (key === 'class') {\n      el.className = newProps[key]\n    } else {\n      el.setAttribute(key, newProps[key])\n    }\n\n  }\n}","import { patch } from \"./vdom/patch\"\n\nexport function lifecycleMixin (Vue) {\n  Vue.prototype._update = function (vnode) {\n    const vm = this\n    patch(vm.$el, vnode)\n  }\n}\nexport function mountComponent (vm, el) {\n  vm._update(vm._render())\n}","const oldArrayMethods = Array.prototype\n\nexport const newArrayProto = Object.create(oldArrayMethods)\nlet methods = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'splice',\n  'reverse',\n  'sort'\n]\n\nmethods.forEach(method => {\n  newArrayProto[method] = function (...args) {\n    const result = oldArrayMethods[method].apply(this, args)\n    let insert\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        insert = args\n        break\n      case 'splice':\n        insert = args.slice(2)\n        break\n      default:\n        break;\n    }\n\n    if (insert) {\n      this.__ob__.observedArray(insert)\n    }\n    return result\n  }\n})","export function proxy (vm, data, key) {\n  Object.defineProperty(vm, key, {\n    get () {\n      return vm[data][key]\n    },\n    set (val) {\n      vm[data][key] = val\n    }\n  })\n}\n\nexport function defineProperty (target, key, value) {\n  Object.defineProperty(target, key, {\n    enumerable: false,\n    configurable: false,\n    value\n  })\n}","import { newArrayProto } from './array'\nimport { defineProperty } from '../util'\nclass Observer {\n  constructor (data) {\n    defineProperty(data, '__ob__', this)\n    if (Array.isArray(data)) {\n      data.__proto__ = newArrayProto\n      this.observedArray(data)\n      return\n    }\n    this.walk(data)\n  }\n  observedArray (arr) {\n    arr.forEach(item => {\n      observe(item)\n    })\n  }\n  walk (data) {\n    Object.keys(data).forEach(key => {\n      defineReactive(data, key, data[key])\n    })\n  }\n  \n}\nfunction defineReactive (data, key, val) {\n  observe(val)\n  Object.defineProperty(data, key, {\n    get () {\n      console.log('获取值')\n      return val\n    },\n    set (newVal) {\n      console.log('设置值')\n      if (val === newVal) return\n      observe(newVal)\n      val = newVal\n    }\n  })\n}\nexport function observe (data) {\n  if (typeof data !== 'object' || typeof data === null) {\n    return data\n  }\n\n  if (data.__ob__) return data\n  return new Observer(data)\n}","import { observe } from './observer/index'\nimport { proxy } from './util'\nexport function initState (vm) {\n  const opts = vm.$options\n\n  if (opts.props) {\n    initProps(vm)\n  }\n  if (opts.data) {\n    initData(vm)\n  }\n  if (opts.methods) {\n    initMethods(vm)\n  }\n  if (opts.watch) {\n    initWatch(vm)\n  }\n  if (opts.computed) {\n    initComputed(vm)\n  }\n}\n\nfunction initProps () {}\nfunction initData (vm) {\n  let data = vm.$options.data\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data\n  for (let key in data) {\n    proxy(vm, '_data', key)\n  }\n  observe(data)\n}\nfunction initMethods () {}\nfunction initWatch () {}\nfunction initComputed () {}","\nimport { compileToFunction } from './compiler/index'\nimport { mountComponent } from './lifecycle'\nimport { initState } from './state'\nexport function initMixin (Vue) {\n  Vue.prototype._init = function (opts) {\n    \n    const vm = this\n    vm.$options = opts\n    initState(vm)\n    if (vm.$options.el) {\n      vm.$mount(vm.$options.el)\n    }\n\n  }\n  Vue.prototype.$mount = function (el) {\n    const vm = this\n    const opts = vm.$options\n\n    el = document.querySelector(el)\n    vm.$el = el\n    if (!opts.render) {\n      let template = opts.template\n      if (!template && el) {\n        template = el.outerHTML\n      }\n      opts.render = compileToFunction(template)\n    }\n\n    mountComponent(vm, el)\n  }\n}","export function renderMixin (Vue) {\n  Vue.prototype._c = function () {\n    return createElement(...arguments)\n  }\n  Vue.prototype._s = function (val) {\n    return val === null ? '' : (typeof val === 'object' ? JSON.stringify(val) : val)\n  }\n  Vue.prototype._v = function (text) {\n    return createTextVnode(text)\n  }\n  Vue.prototype._render = function () {\n    const vm = this\n    const render = vm.$options.render\n\n    const vnode = render.call(vm)\n    return vnode\n  }\n}\n\nfunction createElement (tag, data = {}, ...children) {\n  return vnode(tag, data, data.key, children)\n}\n\nfunction createTextVnode (text) {\n  return vnode(undefined, undefined, undefined, undefined, text)\n}\n\nfunction vnode (tag, data, key, children, text) {\n  return {\n    tag,\n    data,\n    key,\n    children,\n    text\n  }\n}","import { initMixin } from \"./init\"\nimport { lifecycleMixin } from \"./lifecycle\"\nimport { renderMixin } from \"./vdom/index\"\n\nfunction Vue (options) {\n  this._init(options)\n}\ninitMixin(Vue)\nrenderMixin(Vue)\nlifecycleMixin(Vue)\n\nexport default Vue"],"names":["defaultTagRe","generate","ast","children","genChildren","code","tag","attrs","length","genProps","str","i","attr","name","obj","value","split","forEach","item","key","JSON","stringify","slice","map","child","gen","join","type","text","test","tokens","lastIndex","match","index","exec","push","trim","attribute","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","htmlParser","html","root","currentParent","stack","textEnd","indexOf","startTagMatch","parseStartTag","start","tagName","endTagMatch","advance","end","substring","chars","console","log","n","createASTElement","parent","element","pop","compileToFunction","template","render","Function","patch","oldVnode","vnode","el","createEle","parentEl","parentNode","insertBefore","nextSibling","removeChild","data","document","createElement","patchProps","appendChild","createTextNode","newProps","s","style","className","setAttribute","lifecycleMixin","Vue","prototype","_update","vm","$el","mountComponent","_render","oldArrayMethods","Array","newArrayProto","Object","create","methods","method","args","result","apply","insert","__ob__","observedArray","proxy","defineProperty","get","set","val","target","enumerable","configurable","Observer","constructor","isArray","__proto__","walk","arr","observe","keys","defineReactive","newVal","initState","opts","$options","props","initData","watch","computed","_data","call","initMixin","_init","$mount","querySelector","outerHTML","renderMixin","_c","arguments","_s","_v","createTextVnode","undefined","options"],"mappings":"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"}